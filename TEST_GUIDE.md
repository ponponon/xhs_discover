# 自动提取功能测试指南

## 测试前准备

1. **重新加载扩展**
   - 打开 Chrome 扩展管理页面：`chrome://extensions/`
   - 找到"小红书帖子提取器"扩展
   - 点击刷新按钮重新加载扩展

2. **打开开发者工具**
   - 在扩展图标上右键点击
   - 选择"检查弹出内容"
   - 这将打开开发者工具的 Console 标签

## 测试步骤

### 测试1：自动提取开关功能

1. 打开小红书探索页面：https://www.xiaohongshu.com/explore
2. 点击扩展图标打开弹出窗口
3. 查看控制台日志，应该看到：
   ```
   [XHS Popup] 加载设置...
   [XHS Popup] 从存储加载的设置: { autoExtractSettings: {...} }
   ```
4. 点击"自动提取"开关
5. 查看控制台日志，应该看到：
   ```
   [XHS Popup] 自动提取开关被点击
   [XHS Popup] 切换自动提取状态，当前状态: false
   [XHS Popup] 新状态: true
   [XHS Popup] 状态已保存到存储
   ```
6. 验证UI变化：
   - 开关应该变成红色（激活状态）
   - 状态指示器应该变成绿色并闪烁
   - 状态文本应该显示"运行中"
   - 应该显示通知"自动提取已启用"

### 测试2：设置面板功能

1. 点击"⚙️ 设置"按钮
2. 查看控制台日志，应该看到：
   ```
   [XHS Popup] 设置按钮被点击
   ```
3. 验证设置面板打开：
   - 应该显示设置模态框
   - 所有设置项应该显示当前值
4. 修改一些设置（例如：检测间隔改为3秒）
5. 点击"保存"按钮
6. 查看控制台日志，应该看到：
   ```
   [XHS Popup] 保存设置按钮被点击
   [XHS Popup] 保存设置...
   [XHS Popup] 新设置值: { extractOnLoad: true, detectOnScroll: true, detectInterval: 3, ... }
   [XHS Popup] 保存到存储: { enabled: true, ... }
   [XHS Popup] 设置已保存到存储
   ```
7. 验证设置面板关闭
8. 重新打开设置面板，验证修改的值已保存

### 测试3：关闭设置面板

1. 打开设置面板
2. 点击"×"关闭按钮或"取消"按钮
3. 查看控制台日志，应该看到：
   ```
   [XHS Popup] 关闭设置按钮被点击
   ```
   或
   ```
   [XHS Popup] 取消设置按钮被点击
   ```
4. 验证设置面板关闭

## 常见问题排查

### 问题1：点击开关没有任何反应

**可能原因：**
- 扩展未正确重新加载
- 控制台有JavaScript错误

**解决方法：**
1. 检查控制台是否有错误信息
2. 重新加载扩展
3. 清除浏览器缓存后重试

### 问题2：设置保存后没有生效

**可能原因：**
- Chrome存储API权限问题
- 设置值未正确读取

**解决方法：**
1. 检查控制台日志确认设置已保存
2. 检查manifest.json中的storage权限
3. 清除扩展存储后重试

### 问题3：通知不显示

**可能原因：**
- "提取时显示通知"设置未启用
- 通知显示时间太短

**解决方法：**
1. 检查设置中的"提取时显示通知"是否勾选
2. 增加通知显示时间（修改popup.js中的setTimeout时间）

## 调试技巧

### 查看存储的设置

在控制台运行以下代码查看当前存储的设置：

```javascript
chrome.storage.local.get(['autoExtractSettings'], (result) => {
  console.log('存储的设置:', result);
});
```

### 手动清除存储

如果需要重置所有设置，在控制台运行：

```javascript
chrome.storage.local.clear(() => {
  console.log('存储已清除');
});
```

### 手动触发自动提取

在控制台运行以下代码手动触发自动提取：

```javascript
toggleAutoExtract();
```

## 预期结果

所有测试应该：
- ✅ 控制台显示完整的日志输出
- ✅ UI元素正确响应点击事件
- ✅ 设置正确保存和加载
- ✅ 通知正确显示
- ✅ 自动提取功能正常工作

## 测试完成后

如果所有测试通过，说明功能已正常工作。如果仍有问题，请：
1. 记录控制台的完整日志
2. 记录具体的操作步骤
3. 截图显示问题现象
